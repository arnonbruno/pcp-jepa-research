# Memory: 2026-02-23

## Research Status: Paper-Ready Cleanup Complete

### Project Evolution

The project evolved from an ambitious multi-phase plan (PCP-JEPA with O1/O2/O3 objectives) into an empirical investigation with a clear **negative result** and a constructive **positive baseline**.

### Core Findings

#### Negative Result (Main Contribution)
Standard Latent JEPA rollout (`z_next = z + Δz`) diverges exponentially in high-dimensional continuous control. This failure is:
- **Architectural, not data-limited** (prediction/velocity loss ratio ~50–100× at all data scales)
- **Not hybrid-specific** (fails on smooth systems too)
- **Persistent despite stabilization** (residual dynamics, EMA, stop-gradient, multi-step training)

#### Positive Result (Baseline Foil)
**PANO (Physics-Anchored Neural Observer)** recovers partial performance by:
- Predicting observation-space velocity from action history
- Euler integrating: `obs_est = frozen_obs + v_pred × dt × steps`
- Avoiding latent space entirely

#### Bouncing Ball (1D Validation)
F3-JEPA achieves 100% success vs FD's 80% under post-impact dropout in 1D. This initial success motivated the scale-up, where the approach fails.

---

## Key Results

### Bouncing Ball (Phase 5)

| Dropout Steps | F3-JEPA | FD |
|---|---|---|
| 0 | 100% | 100% |
| 1+ | **100%** | 80% |

### Hopper (Phase 6)

Methods evaluated with 100 episodes, Welch's t-tests, and 95% bootstrap CIs:
- Oracle (no dropout) — upper bound
- Frozen Baseline (dropout) — lower bound
- EKF Baseline — classical comparison
- PANO — partial recovery
- Standard Latent JEPA — diverges/underperforms

### Multi-Environment Ablation

Standard Latent JEPA tested on: Hopper-v4, Walker2d-v4, HalfCheetah-v4, InvertedDoublePendulum-v4.

---

## Architecture Names

| Old Name | New Name | Description |
|---|---|---|
| F3-JEPA v4 | **PANO** | Physics-Anchored Neural Observer |
| F3-JEPA v5 | **Standard Latent JEPA** | Residual latent dynamics (diverges) |
| F3-JEPA | F3-JEPA | Bouncing ball version (1D, works) |

---

## Critical Implementation Details

### Loss Balancing (CRITICAL)
```python
lambda_vel = 10.0   # HIGH: physics anchor
lambda_pred = 0.1   # LOW: prevent latent domination
```

### EMA + Stop-Gradient
```python
z_target = target_encoder(x_next, x).detach()
```

---

## Repository Structure

**Active code:**
- `experiments/phase5/f3_jepa.py` — Bouncing ball F3-JEPA
- `experiments/phase6/hopper_pano.py` — PANO main evaluation
- `experiments/phase6/bulletproof_negative.py` — 3-experiment negative protocol
- `experiments/phase6/neurips_figures.py` — Data-driven figures
- `src/evaluation/stats.py` — Statistical testing

**Archived:** `archive_phase1_to_4/` — JAX/Flax experiments (not used)

**Reproducibility:** `./run_neurips_evals.sh`

---

## What Changed Today

1. Archived all JAX/Flax code to `archive_phase1_to_4/`
2. Renamed v4→PANO, v5→Standard Latent JEPA throughout
3. Added EKF baseline to hopper evaluation
4. Added multi-environment ablation (Walker2d, HalfCheetah, InvertedDoublePendulum)
5. Increased eval episodes to 100 with proper statistical tests
6. Made figures data-driven (read from JSON, no hardcoded numbers)
7. Increased oracle training from 100k→1M steps
8. Rewrote README, DOCUMENTATION, memory files
9. Fixed reproduction script with proper arguments

---

*Last updated: 2026-02-23*
